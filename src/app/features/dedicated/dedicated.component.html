<!-- Banner -->
<section class="breadcumnd__banner">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6">
        <div class="banner__content">
          <h6>{{ text('dedicated') }}</h6>
          <h4>{{ text('highPerformanceDedicated') }}</h4>
          <ul class="ssd__list">
            <li><span><i class="fa-solid fa-arrow-right"></i></span> {{ text('fullRootAccess') }}</li>
            <li><span><i class="fa-solid fa-arrow-right"></i></span> {{ text('dedicatedResources') }}</li>
            <li><span><i class="fa-solid fa-arrow-right"></i></span> {{ text('support247Monitoring') }}</li>
          </ul>
            <a [href]="whatsappLink" class="hero-cta-btn">
              <span class="btn-text">{{ text('getStartedNow') }}</span>
              <i class="fa-brands fa-whatsapp btn-icon"></i>
              <span class="btn-glow"></span>
            </a>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="banner__Thumb">
          <img src="assets/img/hosting/clidhost.png" alt="Dedicated Server">
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Filter Sidebar -->
<div class="filter-overlay" [class.active]="filterSidebarOpen" (click)="closeFilterSidebar()"></div>

<aside class="filter-sidebar" [class.active]="filterSidebarOpen">
  <div class="filter-sidebar-header">
    <h5 class="filter-sidebar-title" style="color:#00cdfb;">
      <i class="fa-solid fa-sliders"></i>
      {{ text('filterServers') }}
    </h5>
    <button class="close-btn" (click)="closeFilterSidebar()" aria-label="Close">
      <i class="fa-solid fa-times"></i>
    </button>
  </div>

  <div class="filter-sidebar-content">
    <div class="filter-group">
      <label class="form-label"><i class="fa-solid fa-microchip"></i> {{ text('cpuCores') }}</label>
      <div class="checkbox-group horizontal">
        <label class="checkbox-item" *ngFor="let core of cpuOptions">
          <input type="checkbox" [checked]="filters.cores.includes(core)" (change)="toggleCore(core)">
          <span class="checkmark"></span>
          {{ core }} {{ text('core') }}{{ core !== '1' ? 's' : '' }}
        </label>
      </div>
    </div>

    <div class="filter-group">
      <label class="form-label"><i class="fa-solid fa-memory"></i> {{ text('ram') }}</label>
      <div class="checkbox-group horizontal">
        <label class="checkbox-item" *ngFor="let ram of ramOptions">
          <input type="checkbox" [checked]="filters.ram.includes(ram)" (change)="toggleRam(ram)">
          <span class="checkmark"></span>
          {{ ram }} GB
        </label>
      </div>
    </div>

    <div class="filter-group">
      <label class="form-label"><i class="fa-solid fa-server"></i> {{ text('brand') }}</label>
      <div class="checkbox-group horizontal">
        <label class="checkbox-item" *ngFor="let brand of brandOptions">
          <input type="checkbox" [checked]="filters.brands.includes(brand)" (change)="toggleBrand(brand)">
          <span class="checkmark"></span>
          {{ brand }}
        </label>
      </div>
    </div>

    <div class="filter-group">
      <label class="form-label"><i class="fa-solid fa-dollar-sign"></i> {{ text('maxPrice') }} (USD)</label>
      <div class="price-slider-container">
        <input type="range" class="price-slider" [(ngModel)]="filters.maxPrice" min="0" max="1000" step="10"
               (input)="applyFilters()">
        <div class="price-slider-values">
          <span>${{ filters.maxPrice || 0 }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="filter-actions-instant">
    <button class="btn-clear-all" (click)="resetFilters()" *ngIf="getActiveFilterCount() > 0">
      <i class="fa-solid fa-rotate-right"></i> {{ text('clearAll') }}
    </button>
    <button class="btn-close" (click)="closeFilterSidebar()">
      <i class="fa-solid fa-times"></i> {{ text('close') }}
    </button>
  </div>
</aside>

<!-- Top 3 Featured Servers - FIXED -->
<section class="featured-servers pt-60 pb-40"
         *ngIf="!loading && topThree.length === 3"
         id="Top_Dedicated_Servers">
  <div class="container">
    <div class="section__header text-center">
      <span class="subtitle">{{ text('bestDeals') }}</span>
      <h3 class="section-title">{{ text('topDedicatedThisMonth') }}</h3>
      <p class="section-desc">{{ text('moneyBackUptimeSupport') }}</p>
    </div>

    <div class="featured-grid">
      <ng-container *ngFor="let item of topThree; trackBy: trackByTopThree">
        <div class="featured-card" [class.popular]="item.type === 'value'">
          <div class="badge-discount" *ngIf="item.type === 'intel'">{{ text('bestIntel') }}</div>
          <div class="badge-discount" *ngIf="item.type === 'amd'">{{ text('bestAmd') }}</div>
          <div class="badge-popular" *ngIf="item.type === 'value'">{{ text('bestValue') }}</div>
          <div class="badge-discount" *ngIf="item.type === 'fallback'">{{ text('greatDeal') }}</div>

          <div class="featured-card-header">
            <h4 class="plan-name">{{ item.server.name }}</h4>
            <p class="plan-subtitle-category">{{ item.server.brand || item.server.cpuModel }}</p>
            <p class="plan-subtitle">{{ getSubtitleForType(item.type) }}</p>
          </div>

          <div class="price-section">
            <div class="price-tag">
              <span class="currency">US$</span>
              <span class="amount">{{ item.server.price }}</span>
              <span class="period">/mo</span>
            </div>
          </div>

          <ul class="featured-specs">
            <li><i class="fa-solid fa-microchip"></i> {{ item.server.cores }} {{ text('cores') }}</li>
            <li><i class="fa-solid fa-memory"></i> {{ item.server.ramGB }} GB {{ text('ramLabel') }}</li>
            <li><i class="fa-solid fa-hard-drive"></i> {{ item.server.storage || item.server.storageGB }}</li>
            <li><i class="fa-solid fa-gauge-high"></i> {{ item.server.connectionSpeed || '10 Gbps' }}</li>
          </ul>

          <div class="featured-card-footer">
            <button class="btn-order" (click)="orderNow(item.server.id)">
              <span>{{ text('orderNow') }}</span>
              <i class="fa-solid fa-arrow-right"></i>
            </button>
            <div class="limited-time-deal"><span>{{ text('limitedDeal') }}</span></div>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</section>
<!-- All Plans Section with Processor Tabs + Sidebar Filter -->
<section class="pricing__domain pt-60 pb-120" id="Dedicated">
  <div class="container-fluid px-4">
    <div class="section__header text-center">
      <span class="subtitle">{{ text('fullPower') }}</span>

      <div class="processor-tabs">
        <button class="processor-tab"
                [class.active]="processorFilter === 'all'"
                (click)="setProcessorFilter('all')">
          <i class="fa-solid fa-server"></i> {{ text('all') }}
        </button>
        <button class="processor-tab"
                [class.active]="processorFilter === 'amd'"
                (click)="setProcessorFilter('amd')">
          <i class="fa-solid fa-microchip"></i> AMD
        </button>
        <button class="processor-tab"
                [class.active]="processorFilter === 'intel'"
                (click)="setProcessorFilter('intel')">
          <i class="fa-solid fa-microchip"></i> Intel
        </button>
      </div>

      <h3 class="section-title d-flex justify-content-center align-items-center gap-3 flex-wrap">
        <div class="filter-title-group">
          <span class="filter-title-text">{{ text('filter') }}</span>
          <button class="filter-toggle-btn-inline"
                  [class.active]="filterSidebarOpen || getActiveFilterCount() > 0"
                  (click)="toggleFilterSidebar()">
            <i class="fa-solid fa-sliders" [class.fa-times]="filterSidebarOpen"></i>
            <span class="filter-count-badge" *ngIf="getActiveFilterCount() > 0">{{ getActiveFilterCount() }}</span>
          </button>
        </div>
        <span class="all-plans-text">{{ text('allDedicatedServers') }}</span>
      </h3>

      <p class="section-desc">
        {{ filtered.length }} {{ text('server') }}{{ filtered.length !== 1 ? 's' : '' }} {{ text('available') }}
        <span class="filter-text" *ngIf="getActiveFilterCount() > 0">
          â€¢ {{ getActiveFilterCount() }} {{ text('filter') }}{{ getActiveFilterCount() > 1 ? 's' : '' }} {{ text('applied') }}
        </span>
      </p>
    </div>

    <div class="loading-state" *ngIf="loading">
      <div class="spinner"></div>
      <p>{{ text('loadingDedicated') }}</p>
    </div>

    <div class="error-state" *ngIf="error && !loading">
      <i class="fa-solid fa-exclamation-triangle"></i>
      <h4>{{ text('errorOccurred') }}</h4>
      <p>{{ error }}</p>
      <button class="btn-retry" (click)="loadProducts()"><i class="fa-solid fa-rotate-right"></i> {{ text('tryAgain') }}</button>
    </div>

    <div class="no-results-enhanced" *ngIf="!loading && filtered.length === 0">
      <div class="no-results-icon"><i class="fa-solid fa-server"></i></div>
      <h4 class="no-results-title">{{ text('noDedicatedFound') }}</h4>
      <p class="no-results-subtitle">{{ text('tryAdjustFilters') }}</p>
      <button class="btn btn-primary" (click)="resetFilters()"><i class="fa-solid fa-rotate-right"></i> {{ text('clearFilters') }}</button>
    </div>

    <div class="featured-grid all-plans-grid" *ngIf="!loading && filtered.length > 0">
      <div class="featured-card" *ngFor="let p of filtered; trackBy: trackByFn">
        <div class="badge-discount" *ngIf="p.discount">{{ p.discount }} OFF</div>

        <div class="featured-card-header">
          <h4 class="plan-name">{{ p.name }}</h4>
          <p class="plan-subtitle-category">{{ p.brand }}</p>
          <p class="plan-subtitle">{{ text('fullRoot100Dedicated') }}</p>
        </div>

        <div class="price-section">
          <div class="price-tag">
            <span class="currency">US$</span>
            <span class="amount">{{ p.price }}</span>
            <span class="period">/mo</span>
          </div>
        </div>

        <ul class="featured-specs">
          <li><i class="fa-solid fa-microchip"></i> {{ p.cores }} {{ text('cpuCores') }}</li>
          <li><i class="fa-solid fa-memory"></i> {{ p.ramGB }} GB {{ text('ramLabel') }}</li>
          <li><i class="fa-solid fa-hard-drive"></i> {{ p.storage || p.storageGB }}</li>
          <li *ngIf="p.connectionSpeed"><i class="fa-solid fa-gauge-high"></i> {{ p.connectionSpeed }}</li>
        </ul>

        <div class="featured-card-footer">
          <button class="btn-order" (click)="orderNow(p.id)">
            <span>{{ text('orderNow') }}</span>
            <i class="fa-solid fa-arrow-right"></i>
          </button>
          <div class="limited-time-deal" *ngIf="p.limited">
            <span>{{ text('limitedDeal') }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
